!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("vue"),require("jquery"),require("prism"),require("autosize")):"function"==typeof define&&define.amd?define(["vue","jquery","prism","autosize"],e):e(t.Vue,t.jQuery,t.Prism,t.autosize)}(this,function(t,e,n,i){"use strict";t="default"in t?t["default"]:t,e="default"in e?e["default"]:e,n="default"in n?n["default"]:n,i="default"in i?i["default"]:i;var o={};o.classCallCheck=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},o.createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();var r=void 0,s=function(){function t(){return o.classCallCheck(this,t),r||(r=this),r}return o.createClass(t,[{key:"configure",value:function(t,n){this.routes=t,e.ajaxSetup({headers:{"X-CSRF-TOKEN":n}})}},{key:"get",value:function(t){return this.req(this.route("index"),"GET",t)}},{key:"store",value:function(t){return this.req(this.route("store"),"POST",t)}},{key:"find",value:function(t){return this.req(this.route("show",{id:t}),"GET")}},{key:"update",value:function(t,e){var n=this.route("update",{id:t});return t||(n=n.substr(0,n.length-1)),this.req(n,"PUT",e)}},{key:"destroy",value:function(t){return this.req(this.route("destroy",{id:t}),"DELETE")}},{key:"vote",value:function(t,e){return this.req(this.route("vote",{id:t}),"POST",{type:e})}},{key:"updateSettings",value:function(t){return this.req(this.route("settings"),"PUT",{settings:t})}},{key:"route",value:function n(t,e){var n=this.routes[t]||"";if(e)for(var i in e)n=n.replace(":"+i,e[i]);return n}},{key:"req",value:function(t,n){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return["POST","GET"].indexOf(n)<0&&(i._method=n,n="POST"),e.ajax({url:t,type:n,data:i,dataType:"json"})}}]),t}(),a=r?r:new s,u={template:"#alert-template",props:["success","errors"],computed:{text:function(){return"string"==typeof this.errors}},methods:{close:function(){this.errors=null,this.success=null}}},c={hierarchical:function(t){t.replies=l(t.replies,t.id)},timeago:function(t){e.fn.timeago&&e(t).find("time").timeago()},scroll:function(t){var n=arguments.length<=1||void 0===arguments[1]?400:arguments[1];e("body, html").animate({scrollTop:t},n)},param:function(t,e){var n=h("_escaped_fragment_",window.location.search),i=n?"#"+n:window.location.hash.replace("#!","#");return parseInt(h(t,i,!0))||e},highlight:function(t){n&&e(t).find("pre code").each(function(t,e){n.highlightElement(e)})},loadingDir:function(){return{update:function(t){var n=void 0,i="Loading...";"boolean"==typeof t?n=t:(n=t.state,i=t.text||i),this.el.disabled=!!n;var o=e(this.el);n?(this.originalText=o.text(),o.text(i)):this.originalText&&o.text(this.originalText)}}},directives:{loading:{update:function(t){var n=void 0,i="Loading...";"boolean"==typeof t?n=t:(n=t.state,i=t.text||i),this.el.disabled=!!n;var o=e(this.el);n?(this.originalText=o.text(),o.text(i)):this.originalText&&o.text(this.originalText)}},disable:function(t){this.el.disabled=!!t}},fadeTransition:{enter:function(t,n){e(t).css("opacity",0).animate({opacity:1},300,n)},enterCancelled:function(t){e(t).stop()},leave:function(t,n){e(t).animate({opacity:0},300,n)},leaveCancelled:function(t){e(t).stop()}},emojiFilter:function(t){return window.twemoji?window.twemoji.parse(t,{size:36}):t}},h=function(t,e,n){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp((n?"[\\#]":"[\\?&]")+t+"=([^&#]*)"),o=i.exec(e);return o?decodeURIComponent(o[1].replace(/\+/g," ")):null},l=function w(t,e){var n=[];return t.forEach(function(i){i.parent_id===e&&(i.replies=w(t,i.id),n.push(i))}),n},d=window.commentsConfig||window.adminConfig||{},m={template:"#post-form-template",props:{total:{"default":0},parent:{"default":null},show:{type:Boolean,"default":!0},focus:{type:Boolean,"default":!1},commentList:{type:Array,"default":function(){return[]}}},components:{alert:u},directives:c.directives,data:function(){return{loading:!1,errors:null,reWidgetId:null,content:"",authorName:"",authorEmail:"",authorUrl:"",captchaRequired:d.captchaRequired,maxLength:d.maxLength}},attached:function(){this.recallAuthor(),this.focus&&this.onFocus()},watch:{focus:function(t){t&&this.onFocus()}},methods:{onFocus:function(){var t=this,n=e(this.$el),o=n.find("textarea");i(o),o.focus(),d.captchaRequired&&this.$nextTick(function(){t.renderRecaptcha(n.find("#recaptcha")[0])})},onSubmit:function(t){var e=this;t.preventDefault(),this.errors=null,this.loading=!0,a.store({content:this.content,author_name:this.authorName,author_email:this.authorEmail,author_url:this.authorUrl,page_id:d.pageId,parent_id:this.parent?this.parent.id:null,root_id:this.parent?this.parent.root_id||this.parent.id:null,permalink:d.permalink,"g-recaptcha-response":this.recaptchaResponse()}).done(function(t){return e.onSuccess(t)}).fail(function(t){return e.onError(t)}).always(function(){return e.loading=!1})},onSuccess:function(t){this.parent?this.parent.replies.unshift(t):this.commentList.unshift(t),this.total+=1,this.parent?this.show=!1:this.focus=!1,this.errors=null,this.content="",this.rememberAuthor()},onError:function(t){this.errors=t.responseJSON||"Unexpected error.",null!==this.reWidgetId&&window.grecaptcha.reset(this.reWidgetId)},cancel:function(){this.errors=null,this.parent?this.show=!1:(this.focus=!1,this.content=""),i.destroy(e(this.$el).find("textarea"))},recallAuthor:function(){var t=window.localStorage.getItem(d.storageKey);try{t=JSON.parse(t)}catch(e){}return t?(t.name&&(this.authorName=t.name),t.email&&(this.authorEmail=t.email),void(t.url&&(this.authorUrl=t.url))):!1},rememberAuthor:function(){window.localStorage.setItem(d.storageKey,JSON.stringify({name:this.authorName,email:this.authorEmail,url:this.authorUrl}))},renderRecaptcha:function(t){this.reWidgetId=window.grecaptcha.render(t,{sitekey:d.recaptcha})},recaptchaResponse:function(){if(null!==this.reWidgetId)try{return window.grecaptcha.getResponse(this.reWidgetId)}catch(t){}},authorized:function(){return d.authorized},user:function(){return d.user}}},f="up",p="down",g="remove";t.component("comment",{template:"#comment-template",components:{alert:u,postForm:m},props:["comment","config","parent","target","total"],directives:c.directives,filters:{emoji:c.emojiFilter},transitions:{fade:c.fadeTransition},data:function(){return{collapsed:!1,showEdit:!1,showReply:!1,content:"",errors:null,loading:!1,maxLength:d.maxLength}},created:function(){var t=this;this.$on("comment."+this.comment.id,function(e){t.comment.replies.unshift(e)})},ready:function(){c.timeago(this.$el),c.highlight(this.$el)},computed:{moderate:function(){return d.user&&d.user.admin},editable:function(){return this.comment.canEdit&&"approved"===this.comment.status||this.moderate},upvoted:function(){return this.comment.voted===f},downvoted:function(){return this.comment.voted===p}},methods:{reply:function(t){t.preventDefault(),this.showReply=!this.showReply},edit:function(t){var n=this;t.preventDefault(),this.showEdit=!0,this.showReply&&(this.showReply=!1),this.$nextTick(function(){i(e(n.$el).find("textarea"))})},save:function(t){var e=this;t.preventDefault(),this.loading=!0,a.update(this.comment.id,{content:this.content}).done(function(t){e.showEdit=!1,e.errors=null,e.content="",e.comment.content=t.content,e.comment.contentHTML=t.contentHTML,e.comment.status=t.status,e.$nextTick(function(){c.highlight(e.$el)})}).always(function(){e.loading=!1}).fail(function(t){e.errors=t.responseJSON||"Unexpected error."})},upvote:function(t){this.vote(f,t)},downvote:function(t){this.vote(p,t)},vote:function(t,e){return e.preventDefault(),d.user?this.comment.voted===t?(this.comment.voted=null,t===f?this.comment.upvotes-=1:this.comment.downvotes-=1,a.vote(this.comment.id,g),!1):(this.comment.voted===f&&t===p?this.comment.upvotes-=1:this.comment.voted===p&&t===f&&(this.comment.downvotes-=1),this.comment.voted=t,t===f?this.comment.upvotes+=1:this.comment.downvotes+=1,void a.vote(this.comment.id,t)):alert("You must be logged in to vote!")},votes:function(){return d.votes},replies:function(){return d.replies}}});var v=function(){function t(e,n){o.classCallCheck(this,t),this.channel=e,this.driver=n.driver,this.instance=this.createDriver(n)}return o.createClass(t,[{key:"on",value:function(t,e){switch(this.driver){case"pusher":return this.instance.subscribe(this.channel).bind(t,e);case"redis":return this.instance.on(this.channel+":"+t,e)}}},{key:"createDriver",value:function(t){switch(t.driver){case"pusher":return new Pusher(t.pusherKey);case"redis":return io(t.socket)}}}]),t}();a.configure(d.routes,d.csrfToken);var y={template:"#comments-template",directives:c.directives,components:{postForm:m},transitions:{fade:c.fadeTransition},data:function(){return{loading:!1,initialized:!1,sort:null,sortText:"",sortOptions:d.sortOptions,page:c.param("page",1),target:c.param("comment",null),total:0,pagination:{},commentList:[]}},compiled:function(){this.sortBy(d.sortBy),d.broadcasting&&this.initListener()},methods:{fetch:function(){this.loading=!0,a.get({page:this.page,sort:this.sort,target:this.target,page_id:d.pageId}).done(this._fetchDone.bind(this))},_fetchDone:function(t){var n=this;t.comments.forEach(c.hierarchical),this.total=t.total,this.pagination=t.pagination,this.commentList=t.comments,this.loading=!1,this.initialized=!0,this.target&&this.$nextTick(function(){var t=e("#comment-"+n.target);t.length&&c.scroll(t.offset().top-15,200)})},sortBy:function(t,e){e&&(e.preventDefault(),this.page=1,this.target=null),t===this.sort&&e||(this.sort=t,this.sortText=this.sortOptions[t],this.fetch())},changePage:function(t,n){t?(c.scroll(e(".comments").offset().top),this.page=t,this.target=null,this.fetch()):n.preventDefault()},initListener:function(){var t=this,e=new v("comment."+d.pageId,d.broadcasting);e.on("Hazzard\\Comments\\Events\\BroadcastCommentWasPosted",function(e){t.pushComment(e.comment)})},pushComment:function(t){return t.uid===d.uid?!1:(this.total+=1,void(t.parent_id?this.$broadcast("comment."+t.parent_id,t):this.commentList.unshift(t)))},authorized:function(){return d.authorized}}};t.component("comments",y)});